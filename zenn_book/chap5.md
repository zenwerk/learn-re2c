# 入力終端処理


http://re2c.org/manual/manual_c.html#handling-the-end-of-input

## レキサーはいつ停止するのか？

レキサーの行き着く状態は大まかに以下の３つです。

1. 定義したルールにマッチしながら、最後の状態（最後の遷移先）に到達する
2. どのルールにも一致せず、デフォルトの状態になる
3. 入力された文字列を最後まで読み込む

`１`は成功、`２`は失敗で、どちらにしても遷移先がないのでレキサーは停止します。
`３`は入力を終了とするかどうかは条件によって異なります。
バッファからの入力文字をすべて読み込むことはレキサーがどの状態でも起こりうるので、レクサーはそれを適切に処理する必要があります。

レキサーを正しく停止させるため、re2c では４つの方法があります。

## ４つ方法

1. 番兵文字をつかう（簡単・高効率・制限あり）
2. パディングによる境界チェック（汎用的だが複雑）
3. `EOF`ルール　→　番兵文字と境界チェックの組み合わせ
   1. 一般的で単純
      - 文法によっては`パディングによる境界チェック`よりも効率がよい
4. ジェネリックAPIを使用
   1. ユーザー側ですべての動作を定義するので、生成されるコードでエラーが出る可能性がある。


次章から順に方法を見ていきます。