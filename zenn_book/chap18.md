# まとめ

これまで確認した諸々はコード上では「`re2c:eof` を設定するかどうか」という点が実装の別れ道となっているように感じます。

つまり re2c では以下のような分岐になる

`re2c:eof` を
  1. 設定する　→　境界チェック付き番兵文字（YYFILLの使用は任意）（汎用API可能）
  2. 設定しない
    1. YYFILLを使用しない　→　単純な「番兵文字」ルール（汎用API可能）
    2. YYFILLを使用する　　→　パディング付き境界チェック

生成後のコードを見ても、単純にファイルを読み込んで字句解析をするだけなら、`re2c:eof` でもパディングでもほぼほぼ同じような処理、コードになると思うので
どちらでも大差はない感じがしますが、個人的には`re2c:eof`でやる方が簡単そうに思えます。
また、汎用APIが使用できるのは `re2c:yyfill:enable = 0` の制限から「境界チェック付き番兵文字」と単純な「番兵文字」に限られるので、その点でも`re2c:eof`を使うことを第一に考えておいたほうがよさそう。

これらの手法の使い分けは、使用したい正規表現ルールと字句解析を行いたいシチュエーションで変わるのでしょうが、どういうルールで使い分けを行うべきなのかは単純に決めれないでしょう。
ただ多くの場合、特にファイルから読み込んで解析するような例ではサンプルコードで示したソースコードを流用することでほとんど対応できると思います。


動作をカスタマイズする点においては、バッファの先頭アドレス(`buf`)と現在解析している字句の先頭アドレス(`tok`)、そして`YYCURSOR`, `YYLIMIT` の各種ポインタを、どのように操作するかということを着目すれば良いでしょう。