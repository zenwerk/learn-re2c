# re2c の特徴（バッファ充填関数と入力終端処理について）

re2c の大きな特徴（面倒な点？）として文字列の入力処理を自分で管理する点があります。
Lex などと違い、入力のバッファリングを自分で管理するため、処理を間違うとバッファオーバーランやセグフォが発生してしまい、意図した動作となりません。


入力バッファの管理に対応するため、re2cには二つの大きな処理（の考え方）を理解する必要があります。

## 1. バッファ充填関数

これは前章で `YYFILL` として記載されたAPIのことです。
例えば、レキサーへの入力が巨大で一度でバッファに収まらない場合、バッファへの入力を複数回にわけて分割して行なう必要があります。
この処理をどう行うかを `YYFILL` で定義する必要があります。
例えば、指定したバイト数ずつファイルから文字列を読み込み、EOFに達するまでレキサーへ入力を供給する関数などを定義します。

:::message
入力がバッファに収まることが確定している場合などは `YYFILL` を定義する必要はありません。
(`re2c:yyfill:enable = 0;` と設定する)
:::


## 2. 入力終端処理

バッファから次々に入力が送られてくる場合、どこかで入力が終了したことを判定する必要があります。
入力内容がファイルなどの固定長サイズの場合はバッファの容量を調べれば判定可能でしょうが、仮にネットワーク越しで入力され全体サイズが不明な場合はどうすれば良いでしょうか？

re2c では様々な入力に対応するため、複数の入力終端処理が用意されています。


## まとめ
re2c は正規表現ルール以外にもバッファ充填処理と入力終端処理という２つの独自の概念を理解しなければならず、これが re2c を難しくしている大きな理由と思われます。

逆にこれらの概念を理解できれば、re2c は様々な入力パターンに対応できるレキサーを自動生成できる強力なツールになり得ます。


次章からまずは入力終端処理を見ていきます。